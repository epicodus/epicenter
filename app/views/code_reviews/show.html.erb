<%= render 'layouts/errors', object: @code_review %>

<h1 class="page-header">
  <%= @code_review.title %>
  <% if current_admin %>
    <div class="btn-group pull-right">
      <%= link_to 'Edit', edit_code_review_path(@code_review), class: 'btn btn-info' %>
      <%= link_to 'Delete', @code_review, data: { method: :delete, confirm: 'Are you sure?' }, class: 'btn btn-primary' %>
      <%= link_to 'New', new_code_review_path, class: 'btn btn-success' %>
    </div>
  <% end %>
</h1>

<h3>Objectives</h3>
<% if @submission.has_been_reviewed? %>
  <div class="table-responsive">
    <table class="table">
      <%= render @submission.latest_review.grades %>
    </table>
  </div>
<% else %>
  <ul class="list-unstyled">
    <div class="table-responsive">
      <table class="table">
        <%= render @code_review.objectives %>
      </table>
    </div>
  </ul>
<% end %>

<% if @submission.needs_review? %>
  <p class='text-muted'>Your submission is pending review.</p>
<% elsif @submission.has_been_reviewed? %>
  <h3>Feedback</h3>
  <div>
    <%= markdown(@submission.latest_review.note) %>
  </div>
<% end %>

<% if can?(:create, Submission) && !@code_review.course.internship_course? %>
  <div class="row">
    <div class="col-md-6">
      <%= render 'submissions/form' %>
    </div>
  </div>
<% end %>
